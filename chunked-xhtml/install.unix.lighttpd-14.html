<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>PHP-Handbuch: Lighttpd 1.4 auf Unix systems</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td style="font-size: smaller;" width="15%">
<style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="index.html">PHP-Handbuch</a></li>
  <li class="header up"><a href="install.html">Installation und Konfiguration</a></li>
  <li class="header up"><a href="install.unix.html">Installation auf Unix-Systemen</a></li>
  <li><a href="install.unix.apache.html">Apache 1.3.x auf Unix-Systemen</a></li>
  <li><a href="install.unix.apache2.html">Apache 2.x auf Unixsystemen</a></li>
  <li><a href="install.unix.nginx.html">Nginx 1.4.x auf Unix Systemen</a></li>
  <li class="active"><a href="install.unix.lighttpd-14.html">Lighttpd 1.4 auf Unix systems</a></li>
  <li><a href="install.unix.sun.html">Sun, iPlanet and Netscape servers on Sun Solaris</a></li>
  <li><a href="install.unix.commandline.html">CGI und Kommandozeilen Setups</a></li>
  <li><a href="install.unix.hpux.html">HP-UX spezifische Installationsnotizen</a></li>
  <li><a href="install.unix.openbsd.html">OpenBSD installation notes</a></li>
  <li><a href="install.unix.solaris.html">Solaris specific installation tips</a></li>
  <li><a href="install.unix.debian.html">Debian GNU/Linux-Installationshinweise</a></li>
 </ul>

        </td>
        <td width="85%">
            <div style="text-align: center;">
                <div class="prev" style="text-align: left; float: left;"><a href="install.unix.nginx.html">Nginx 1.4.x auf Unix Systemen</a></div>
                <div class="next" style="text-align: right; float: right;"><a href="install.unix.sun.html">Sun, iPlanet and Netscape servers on Sun Solaris</a></div>
                <div class="up"><a href="install.unix.html">Installation auf Unix-Systemen</a></div>
                <div class="home"><a href="index.html">PHP-Handbuch</a></div>
            </div><hr/>
<div id="install.unix.lighttpd-14" class="sect1">
 <h2 class="title">Lighttpd 1.4 auf Unix systems</h2>

 <p class="para">
  Dieser Abschnitt enthält Notizen und Hinweise 
  zur Installtion von PHP für Lighttpd 1.4 für Unixsysteme.
 </p>

 <p class="para">
  Bitte benutzen Sie das <a href="http://trac.lighttpd.net/trac/" class="link external">&raquo;&nbsp;Lighttpd trac</a>
  um die ordnungsgemäße Installation von Lighttpd zu lernen bevor Sie fortfahren.
 </p>
 
 <p class="para">
  Fastcgi ist die bevorzugte SAPI um PHP mit Lighttpd zu verbinden. 
  Fastcgi ist automatisch bei php-cgi ab PHP Version 5.3 aktiviert.
  für ältere Version konfigurieren Sie PHP bitte mit der --enable-fastcgi Option.
  Um zu verifizieren, dass fastcgi aktiviert ist benutzen Sie bitte <em>php -v</em>.
  In diesen sollte Ihre Ausgabe <em>PHP 5.2.5 (cgi-fcgi)</em> enthalten.
  Vor PHP 5.2.3 war fastcgi  in der php Binärtdatei aktiviert (es gab noch kein php-cgi).
 </p>
 
 <div class="sect2" id="install.unix.lighttpd-14.lighttpd-spawn">
  <h3 class="title">Lighttpd einen php Prozess starten lassen</h3>

  <p class="para">
   Um Lighttpd so zu konfigurieren, dass es sich mit php verbindet
   und einen fastcgi Prozess startet editieren sie bitte die lighttpd.conf.
   Sockets sind der bevorzugte Weg um sich auf einem lokalen System mit dem
   fastcgi Prozess zu verbinden.
  </p>

  <div class="example" id="example-40">
   <p><strong>Beispiel #1 Partial lighttpd.conf</strong></p>
   <div class="example-contents screen">
<div class="cdata"><pre>
server.modules += ( &quot;mod_fastcgi&quot; )

fastcgi.server = ( &quot;.php&quot; =&gt;
  ((
    &quot;socket&quot; =&gt; &quot;/tmp/php.socket&quot;,
    &quot;bin-path&quot; =&gt; &quot;/usr/local/bin/php-cgi&quot;,
    &quot;bin-environment&quot; =&gt; (
      &quot;PHP_FCGI_CHILDREN&quot; =&gt; &quot;16&quot;,
      &quot;PHP_FCGI_MAX_REQUESTS&quot; =&gt; &quot;10000&quot;
    ),
    &quot;min-procs&quot; =&gt; 1,
    &quot;max-procs&quot; =&gt; 1,
    &quot;idle-timeout&quot; =&gt; 20
  ))
)
</pre></div>

   </div>
  </div>

  <p class="para">
   Der bin-path erlaubt es Lighttpd einen neue fastcgi Prozess automatisch zu starten.
   PHP wird entsprechende der PHP_FCGI_CHILDREN Umgebungsvariable Kindprozesse starte.
   Das &quot;bin-environment&quot; Direktiv konfiguriert die Umgebung für gestartete Prozesse.
   PHP Wir Kindprozesse beenden nachdem die Anzahl von Anfragen laut PHP_FCGI_MAX_REQUESTS erreicht ist.
   Die Direktiven &quot;min-procs&quot; und &quot;max-procs&quot; sollten generell vermieden wirden bei PHP. 
   PHP verwaltet seine eigenen Kindprozesse. Opcode caches wie APC werden nur unter Kindprozessen geteilt,
   welche von PHP verwaltet werden. Wenn &quot;min-procs&quot; auf einen Wert größer 1 gesetzt ist,
   wird die totale Anzahle an &quot;php Respondern&quot; mit PHP_FCGI_CHILDREN multipliziert.
   (2 min-procs * 16 Kindprozesser ergibt 32 Responder)
  </p>
 </div>

 <div class="sect2" id="install.unix.lighttpd-14.spawn-fcgi">
  <h3 class="title">Spawning mit spawn-fcgi</h3>  

  <p class="para">
   Lighttpd bietet ein Programm &quot;spawn-fcgi&quot; an um den Prozess des Erstellens
   von fastcgi Prozessen zu vereinfachen. 
  </p>
 </div>

 <div class="sect2" id="install.unix.lighttpd-14.spawn-php">
  <h3 class="title">Spawning php-cgi</h3>

  <p class="para">
   Es ist möglich Prozesse ohne spawn-fcgi zu starten. Jedoch ist dafür etwas Arbeit nötig.
   Die Umgebungsvariable PHP_FCGI_CHILDREN Umgebungsvariable definiert
   wie viele Kindprozesse PHP spawnen wird um eingehende Anfragen zu bearbeiten.
   PHP_FCGI_MAX_REQUESTS definiert wie lange (in Anfragen) jeder Kindprozess
   existieren wird. Hier ist ein einfaches bash script um das Spawnen von
   PHP Respondern zu vereinfachen.
  </p>
     
  <div class="example" id="example-41">
   <p><strong>Beispiel #2 Spawning FastCGI Responders</strong></p>
   <div class="example-contents screen">
<div class="cdata"><pre>
#!/bin/sh

# Location of the php-cgi binary
PHP=/usr/local/bin/php-cgi

# PID File location
PHP_PID=/tmp/php.pid

# Binding to an address
#FCGI_BIND_ADDRESS=10.0.1.1:10000
# Binding to a domain socket
FCGI_BIND_ADDRESS=/tmp/php.sock

PHP_FCGI_CHILDREN=16
PHP_FCGI_MAX_REQUESTS=10000

env -i PHP_FCGI_CHILDREN=$PHP_FCGI_CHILDREN \
       PHP_FCGI_MAX_REQUESTS=$PHP_FCGI_MAX_REQUESTS \
       $PHP -b $FCGI_BIND_ADDRESS &amp;

echo $! &gt; &quot;$PHP_PID&quot;

</pre></div>
   </div>
  </div>
 </div>

 <div class="sect2" id="install.unix.lighttpd-14.remote-fcgi">
  <h3 class="title">Verbindung zu entfernten FCGI Instanzen</h3>

  <p class="para">
   Um Anwendungen besser zu skalieren können fastcgi Instanzen auf mehreren 
   entfernten Maschinen gestart werden.
  </p>
   
  <div class="example" id="example-42">
   <p><strong>Beispiel #3 Verbindung zu entferten php-fastcgi Instanzen</strong></p>
   <div class="example-contents screen">
<div class="cdata"><pre>
fastcgi.server = ( &quot;.php&quot; =&gt;
   (( &quot;host&quot; =&gt; &quot;10.0.0.2&quot;, &quot;port&quot; =&gt; 1030 ),
    ( &quot;host&quot; =&gt; &quot;10.0.0.3&quot;, &quot;port&quot; =&gt; 1030 ))
)
</pre></div>
   </div>
  </div>
 </div>
</div>
        </td>
    </tr>
</table>
</body>
</html>
